<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Heart Animation</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:#000;
}
canvas{
    position:absolute;
    top:0;
    left:0;
}
#start{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    padding:15px 40px;
    font-size:20px;
    border:none;
    border-radius:30px;
    background:#ff2e63;
    color:white;
    cursor:pointer;
    z-index:10;
}
</style>
</head>
<body>

<button id="start">ðŸ’— Start</button>
<canvas id="canvas"></canvas>

<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

var audio = new Audio("https://files.catbox.moe/p9r1m6.mp3");
audio.loop = true;

var Point = (function () {

    function Point(x, y) {
        this.x = (typeof x !== 'undefined') ? x : 0;
        this.y = (typeof y !== 'undefined') ? y : 0;
    }

    Point.prototype.clone = function () {
        return new Point(this.x, this.y);
    };

    return Point;

})();

var particles = [];
var heartPoints = [];
var time = 0;

function createHeartPoints() {
    heartPoints = [];
    var scale = Math.min(canvas.width, canvas.height) / 40;

    for (var t = 0; t < Math.PI * 2; t += 0.02) {
        var x = 16 * Math.pow(Math.sin(t), 3);
        var y = -(13 * Math.cos(t)
            - 5 * Math.cos(2 * t)
            - 2 * Math.cos(3 * t)
            - Math.cos(4 * t));

        heartPoints.push(new Point(x * scale, y * scale));
    }
}

function Particle(target) {
    this.position = new Point(
        Math.random() * canvas.width,
        Math.random() * canvas.height
    );
    this.target = target.clone();
    this.speed = 0.08;
    this.size = Math.random() * 2 + 1;
}

Particle.prototype.update = function () {
    this.position.x += (canvas.width/2 + this.target.x - this.position.x) * this.speed;
    this.position.y += (canvas.height/2 + this.target.y - this.position.y) * this.speed;
};

Particle.prototype.draw = function (pulse) {
    ctx.beginPath();
    ctx.arc(this.position.x, this.position.y, this.size * pulse, 0, Math.PI * 2);
    ctx.fillStyle = "#ff2e63";
    ctx.shadowBlur = 20;
    ctx.shadowColor = "#ff2e63";
    ctx.fill();
};

function animate() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    time += 0.05;
    var pulse = 1 + Math.sin(time) * 0.15;

    for (var i=0;i<particles.length;i++){
        particles[i].update();
        particles[i].draw(pulse);
    }

    requestAnimationFrame(animate);
}

document.getElementById("start").addEventListener("click", function(){

    this.style.display="none";
    audio.play();

    createHeartPoints();

    for (var i=0;i<heartPoints.length;i++){
        (function(i){
            setTimeout(function(){
                particles.push(new Particle(heartPoints[i]));
            }, i*5);
        })(i);
    }

    animate();
});

window.addEventListener("resize", function(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    createHeartPoints();
});
</script>

</body>
</html>
